<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Compounded Investment Calculator</title>
  <!-- ✅ Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container my-4 p-4 bg-white rounded shadow-sm">
    <h2 class="mb-4 text-center">Compounded Investment Calculator</h2>
    <div class="mb-3">
      <label class="form-label">Starting Amount ($):</label>
      <input type="number" id="startAmount" class="form-control" value="14.38" step="0.01">
    </div>

    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label">Start Date:</label>
        <input type="date" id="startDate" class="form-control">
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label">End Date:</label>
        <input type="date" id="endDate" class="form-control" onchange="updateDaysFromEndDate()">
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label">Number of Days:</label>
      <input type="number" id="days" class="form-control" value="30" oninput="updateEndDateFromDays()">
    </div>

    <button class="btn btn-primary w-100 mb-3" onclick="calculateInvestment()">Calculate Final Amount</button>
    <div class="alert alert-info d-none" id="finalResult"></div>

    <hr>

    <div class="mb-3">
      <label class="form-label">Target Amount ($):</label>
      <input type="number" id="targetAmount" class="form-control" value="100" step="0.01">
    </div>
    <button class="btn btn-success w-100 mb-3" onclick="calculateDaysToTarget()">Calculate Days to Reach Target</button>
    <div class="alert alert-warning d-none" id="targetResult"></div>

    <hr>
    <!-- ✅ Explanation -->
    <div class="mt-4">
      <h5>How the calculation works:</h5>
      <p class="small text-muted">
        Your investment grows by <strong>1% per compounding period</strong>, and there are
        <strong>3 compounding periods per day</strong>. Each 1% increase is <em>rounded to the nearest tenth</em> of a dollar
        before being added back to the balance.  
      </p>
      <p class="small text-muted">
        For example, if your balance is $100, a 1% increase is $1.00. If it were $14.38, a 1% increase is $0.1438, 
        which is rounded to $0.10. The balance is then updated, and the next period’s 1% is calculated on the new rounded amount.
      </p>
      <p class="small text-muted">
        This calculator uses the <strong>Start Date</strong> and <strong>Number of Days</strong> (or <strong>End Date</strong>) to determine the growth period. 
        When you adjust days, the end date updates automatically; when you pick an end date, the days update.
      </p>
    </div>
  </div>

  <!-- ✅ Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const COMPOUNDS_PER_DAY = 3;
    const INCREASE_RATE = 0.01;

    function calculateInvestment() {
      let amount = parseFloat(document.getElementById('startAmount').value);
      let days = parseInt(document.getElementById('days').value);

      for (let i = 0; i < days; i++) {
        for (let j = 0; j < COMPOUNDS_PER_DAY; j++) {
          let increase = amount * INCREASE_RATE;
          let roundedIncrease = Math.round(increase * 10) / 10; // round to nearest tenth
          amount += roundedIncrease;
        }
      }
      const result = document.getElementById('finalResult');
      result.textContent = `Final amount after ${days} days: $${amount.toFixed(2)}`;
      result.classList.remove('d-none');
    }

    function calculateDaysToTarget() {
      let amount = parseFloat(document.getElementById('startAmount').value);
      const target = parseFloat(document.getElementById('targetAmount').value);
      let days = 0;

      while (amount < target) {
        days++;
        for (let j = 0; j < COMPOUNDS_PER_DAY; j++) {
          let increase = amount * INCREASE_RATE;
          let roundedIncrease = Math.round(increase * 10) / 10;
          amount += roundedIncrease;
        }
      }

      const startDate = new Date(document.getElementById('startDate').value);
      const endDate = new Date(startDate);
      endDate.setDate(startDate.getDate() + days);

      document.getElementById('endDate').value = endDate.toISOString().slice(0, 10);
      document.getElementById('days').value = days;

      const result = document.getElementById('targetResult');
      result.textContent = `It will take about ${days} days to reach $${target} (until ${endDate.toDateString()}).`;
      result.classList.remove('d-none');
    }

    function updateEndDateFromDays() {
      const startDate = new Date(document.getElementById('startDate').value);
      const days = parseInt(document.getElementById('days').value || 0);
      if (!isNaN(days)) {
        const newEndDate = new Date(startDate);
        newEndDate.setDate(startDate.getDate() + days);
        document.getElementById('endDate').value = newEndDate.toISOString().slice(0, 10);
      }
    }

    function updateDaysFromEndDate() {
      const startDate = new Date(document.getElementById('startDate').value);
      const endDate = new Date(document.getElementById('endDate').value);
      if (!isNaN(endDate.getTime())) {
        const diffTime = endDate - startDate;
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        document.getElementById('days').value = diffDays;
      }
    }

    // Initialize start date to today
    window.onload = function() {
      const today = new Date();
      const todayStr = today.toISOString().slice(0, 10);
      document.getElementById('startDate').value = todayStr;

      const days = parseInt(document.getElementById('days').value);
      const end = new Date(today);
      end.setDate(today.getDate() + days);
      document.getElementById('endDate').value = end.toISOString().slice(0, 10);
    }
  </script>
</body>
<footer class="text-center mt-5 py-3 bg-light border-top">
  <div class="container">
    <p class="mb-0 text-muted">
      &copy; <span id="year"></span> Compounded Investment Calculator — Created by Your Jayser Pilapil
    </p>
  </div>
</footer>

<script>
  // Auto update year
  document.getElementById('year').textContent = new Date().getFullYear();
</script>

</html>
